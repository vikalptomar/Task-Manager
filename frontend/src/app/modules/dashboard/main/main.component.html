<app-breadcrum title="Dashboard"></app-breadcrum>

<i
  class="add position-fixed bottom-0 end-0 me-4"
  (click)="scrollTop()"
  (click)="addTaskModal(addTask)"
  style="z-index: 99; cursor: pointer; margin-bottom: 100px"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    style="font-size: x-large"
    height="1.25em"
    viewBox="0 0 512 512"
    id="add"
  >
    <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
    <style>
      #add {
        fill: #4b4949;
      }
    </style>
    <path
      d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"
    />
  </svg>
</i>
<i
  class="position-fixed bottom-0 end-0 mb-5 me-4"
  (click)="scrollTop()"
  style="z-index: 99; cursor: pointer"
  *ngIf="currentIndex > 10"
>
  <svg
    xmlns="http://www.w3.org/2000/svg"
    style="font-size: x-large"
    height="1.25em"
    viewBox="0 0 512 512"
    id="top"
  >
    <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
    <style>
      #top {
        fill: #4b4949;
      }
    </style>
    <path
      d="M8 256C8 119 119 8 256 8s248 111 248 248-111 248-248 248S8 393 8 256zm292 116V256h70.9c10.7 0 16.1-13 8.5-20.5L264.5 121.2c-4.7-4.7-12.2-4.7-16.9 0l-115 114.3c-7.6 7.6-2.2 20.5 8.5 20.5H212v116c0 6.6 5.4 12 12 12h64c6.6 0 12-5.4 12-12z"
    />
  </svg>
</i>

<div class="container">
  <div class="body-height row my-5">
    <div
      class="main-box m-auto col-xl-4 col-lg-5 col-md-7 col-sm-12"
      style="position: relative"
    >
      <div
        class="text-end mx-3 my-2"
        style="cursor: pointer"
        (click)="reload()"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="16"
          width="16"
          viewBox="0 0 512 512"
          id="reload"
        >
          <!--!Font Awesome Free 6.5.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2023 Fonticons, Inc.-->
          <style>
            #reload {
              fill: white;
            }
          </style>
          <path
            d="M500.3 0h-47.4a12 12 0 0 0 -12 12.6l4 82.8A247.4 247.4 0 0 0 256 8C119.3 8 7.9 119.5 8 256.2 8.1 393.1 119.1 504 256 504a247.1 247.1 0 0 0 166.2-63.9 12 12 0 0 0 .5-17.4l-34-34a12 12 0 0 0 -16.4-.6A176 176 0 1 1 402.1 157.8l-101.5-4.9a12 12 0 0 0 -12.6 12v47.4a12 12 0 0 0 12 12h200.3a12 12 0 0 0 12-12V12a12 12 0 0 0 -12-12z"
          />
        </svg>
      </div>
      <div class="d-flex row mx-2 mb-4 form-floating">
        <input
          class="col-8 form-control"
          placeholder=""
          id="search"
          type="text"
          [(ngModel)]="filter"
        />
        <label for="search">Search</label>
      </div>
      <div *ngIf="filter.length === 0">
        <div
          class="search-results mb-4"
          infiniteScroll
          [infiniteScrollDistance]="2"
          (scrolled)="onScrollDown()"
        >
          <div class="text-center mt-5" *ngIf="data.length <= 0">
            <h3>Add Todo Task</h3>
          </div>
          <div class="text-center mt-4" *ngIf="data.length <= 0">
            <i
              class="add"
              (click)="scrollTop()"
              (click)="addTaskModal(addTask)"
              style="z-index: 99; cursor: pointer; margin-bottom: 100px"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                style="font-size: x-large"
                height="4.25em"
                viewBox="0 0 512 512"
              >
                <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                <style>
                  svg {
                    fill: #4b4949;
                  }
                </style>
                <path
                  d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"
                />
              </svg>
            </i>
          </div>
          <table class="table table-hover" *ngIf="displayedItems.length > 0">
            <thead>
              <th scope="col fw-bold" style="padding: 8px; color: white">
                Title
              </th>
              <th scope="col fw-bold" style="padding: 8px; color: white">
                Task
              </th>
            </thead>
            <tbody>
              <!-- Use *ngFor to iterate over the displayedItems array -->
              <tr *ngFor="let item of displayedItems">
                <th scope="row">
                  {{
                    item.title.length > 10
                      ? item.title.substring(0, 8) + "..."
                      : item.title
                  }}
                </th>
                <td>
                  {{
                    item.task.length > 15
                      ? item.task.substring(0, 15) + "..."
                      : item.task
                  }}
                </td>
                <td class="text-end" style="padding: 10px; margin: 0px">
                  <i
                    class="me-2 my-0 p-0"
                    style="cursor: pointer"
                    (click)="taskById(item)"
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      height="1em"
                      viewBox="0 0 576 512"
                      id="edit"
                    >
                      <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                      <style>
                        #edit {
                          fill: #5a71ba;
                        }
                      </style>
                      <path
                        d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"
                      />
                    </svg>
                  </i>
                  <i
                    class="p-0 me-2"
                    style="cursor: pointer"
                    (click)="openDeleteModal(deleteTask, item)"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      height="1em"
                      viewBox="0 0 448 512"
                      id="del"
                    >
                      <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                      <style>
                        #del {
                          fill: red;
                        }
                      </style>
                      <path
                        d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"
                      />
                    </svg>
                  </i>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div *ngIf="loadingData">
          <h1 class="text-center" style="color: white">Loading...</h1>
        </div>
      </div>

      <div *ngIf="filter.length > 0">
        <div class="search-results mb-4">
          <div class="text-center mt-5" *ngIf="data.length <= 0">
            <h3>Add Todo Task</h3>
          </div>
          <div class="text-center mt-4" *ngIf="data.length <= 0">
            <i
              class="add"
              (click)="scrollTop()"
              (click)="addTaskModal(addTask)"
              style="z-index: 99; cursor: pointer; margin-bottom: 100px"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                style="font-size: x-large"
                height="4.25em"
                viewBox="0 0 512 512"
              >
                <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                <style>
                  svg {
                    fill: #4b4949;
                  }
                </style>
                <path
                  d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm144 276c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92h-92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"
                />
              </svg>
            </i>
          </div>
          <table class="table table-hover" *ngIf="displayedItems.length > 0">
            <thead>
              <th scope="col fw-bold" style="padding: 8px; color: white">
                Title
              </th>
              <th scope="col fw-bold" style="padding: 8px; color: white">
                Task
              </th>
            </thead>
            <tbody>
              <!-- Use *ngFor to iterate over the displayedItems array -->
              <tr
                *ngFor="let item of data | search : filter : ['title', 'task']"
              >
                <th scope="row">
                  {{
                    item.title.length > 10
                      ? item.title.substring(0, 8) + "..."
                      : item.title
                  }}
                </th>
                <td>
                  {{
                    item.task.length > 15
                      ? item.task.substring(0, 15) + "..."
                      : item.task
                  }}
                </td>
                <td class="text-end">
                  <i
                    class="me-2 my-0 p-0"
                    style="cursor: pointer"
                    (click)="taskById(item)"
                    ><svg
                      xmlns="http://www.w3.org/2000/svg"
                      height="1em"
                      viewBox="0 0 576 512"
                      id="edit"
                    >
                      <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                      <style>
                        #edit {
                          fill: #5a71ba;
                        }
                      </style>
                      <path
                        d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"
                      />
                    </svg>
                  </i>
                  <i
                    class="p-0 me-2"
                    style="cursor: pointer"
                    (click)="openDeleteModal(deleteTask, item)"
                  >
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      height="1em"
                      viewBox="0 0 448 512"
                      id="del"
                    >
                      <!--! Font Awesome Free 6.4.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. -->
                      <style>
                        #del {
                          fill: red;
                        }
                      </style>
                      <path
                        d="M32 464a48 48 0 0 0 48 48h288a48 48 0 0 0 48-48V128H32zm272-256a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zm-96 0a16 16 0 0 1 32 0v224a16 16 0 0 1-32 0zM432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16z"
                      />
                    </svg>
                  </i>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <div *ngIf="loadingData">
          <h1 class="text-center" style="color: rgb(97, 97, 116)">
            Loading...
          </h1>
        </div>
      </div>
    </div>
  </div>
</div>

<ng-template #addTask let-modal>
  <div class="modal-header">
    <h4 class="modal-title pt-2">Add a new Task.</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <h5>Enter Title and Task detail.</h5>
    <div class="form-floating my-3">
      <input
        type="text"
        class="form-control"
        [(ngModel)]="title"
        id="floatingInput"
        placeholder=""
      />
      <label for="floatingInput">Title</label>
    </div>
    <div class="form-floating">
      <textarea
        class="form-control"
        [(ngModel)]="task"
        placeholder=""
        id="floatingTextarea"
        style="height: 200px"
      ></textarea>
      <label for="floatingTextarea">Task Detail...</label>
    </div>
  </div>
  <div class="modal-footer">
    <button
      class="btn btn-success"
      *ngIf="this.title.length > 0 && this.task.length > 0 && !loading"
      (click)="addNewTask()"
    >
      Add Task
    </button>
    <button class="btn btn-success" disabled="true" *ngIf="loading">
      Loading...
    </button>
  </div>
</ng-template>

<ng-template #deleteTask let-modal>
  <div class="modal-header">
    <h4 class="modal-title pt-2">Are you sure?</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <h5>{{ title_modal }} will be Deleted.</h5>
  </div>
  <div class="modal-footer">
    <button class="btn btn-danger" (click)="delete()">CONFIRM</button>
    <button class="btn btn-success" (click)="modal.dismiss('Cross click')">
      DECLINE
    </button>
  </div>
</ng-template>
